---
layout: post
title: vscode-Cé–‹ç™¼ç’°å¢ƒ
date: 2023-07-05 16:50 +0800
categories: [ç’°å¢ƒè¨­å®šèˆ‡éƒ¨å±¬]
tags: [vscode]
---
# å®‰è£llvm clang lldb
ç”¨apt å®‰è£

<!-- # è‡ªè¡Œç·¨è­¯llvm(éå¿…è¦)
åƒè€ƒllvmçš„ç·¨è­¯æµç¨‹(éå¿…è¦)
```bash
cd ~
mkdir buildspace

# Download LLVM/Clang/LLDB and build them.
cd /tmp
git clone https://github.com/llvm/llvm-project.git
mkdir llvm-inst
mkdir llvm-build
cd llvm-build

cmake -DLLVM_ENABLE_PROJECTS="clang;lldb" -DLLVM_ENABLE_RUNTIMES="libcxx;libcxxabi" -DCMAKE_INSTALL_PREFIX=~/buildspace/llvm-inst/ -GNinja -DLLVM_BUILD_LLVM_DYLIB=On -DCMAKE_BUILD_TYPE=Release ../llvm-project/llvm
ninja
ninja install
``` -->

sudo apt install llvm clangd-12 lldb liblldb-dev

<!-- * å»ºç«‹é€£çµ
```bash
sudo ln -s /home/ai_server/buildspace/llvm-inst/bin/clang /usr/bin/clang
sudo ln -s /home/ai_server/buildspace/llvm-inst/bin/clang++ /usr/bin/clang++
sudo ln -s /home/ai_server/buildspace/llvm-inst/bin/lldb /usr/bin/lldb
sudo ln -s /home/ai_server/buildspace/llvm-inst/bin/lldb-server /usr/bin/lldb-server
``` -->

# å®‰è£vscodeå¥—ä»¶
CodeLLDBã€clangd ã€CMake ã€CMake Tools

# è£½ä½œlaunch.jsonå’Œtask.json
tasks.jsonå¯ä»¥è£½ä½œåˆ©ç”¨cmakeä¾†buildçš„å·¥ä½œï¼Œç¯„ä¾‹å¦‚ä¸‹
```json
{
  "version": "2.0.0",
  "tasks": [
        {
            "type": "cmake",
            "label": "CMake: build",
            "command": "build",
            "targets": [
                "all"
            ],
            "group": "build",
            "problemMatcher": [],
            "detail": "CMake template build task"
        }
    ]
}
```
è€Œlaunch.jsonå¯ä»¥å‘¼å«task.jsonè£¡é¢çš„å·¥ä½œï¼Œåªéœ€è¦åœ¨preLaunchTaskä¸­æŒ‡å®šï¼Œç¯„ä¾‹å¦‚ä¸‹
```json
{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "type": "lldb",
            "request": "launch",
            "name": "Debug",
            "program": "${workspaceFolder}/ds61-v2-nvmultiurisrcbin/deepstream-nvmultiurisrcbin",//æŒ‡å®šåŸ·è¡Œæª”çš„è·¯å¾‘
            "args": ["-c", "source4_1080p_dec_parallel_infer.yml"],//åŸ·è¡ŒåŸ·è¡Œæª”çš„åƒæ•¸ï¼Œå¯ä»¥ç‚ºç©º
            "cwd": "${workspaceFolder}/ds61-v2-nvmultiurisrcbin",//æŒ‡å®šå·¥ä½œç›®éŒ„
            "preLaunchTask": "CMake: build"
        }
    ]
}
```

codelldbåœ¨launch.jsonå¯ä»¥ç”¨çš„åƒæ•¸å¦‚ä¸‹
https://github.com/vadimcn/codelldb/blob/master/MANUAL.md


# è¨­å®šsettings.json
è¦è¨­å®šè·¯å¾‘è®“clangdè®€å–cmakeç”¢å‡ºçš„compile_commands.json
```json
{
    "cmake.sourceDirectory": "/home/adlink/deepstream/ds61-v2-nvmultiurisrcbin",
    "cmake.generator": "Unix Makefiles",
    "clangd.arguments": [
        "--compile-commands-dir=${workspaceFolder}/ds61-v2-nvmultiurisrcbin/build",
        // åœ¨åå°è‡ªåŠ¨åˆ†ææ–‡ä»¶ï¼ˆåŸºäºcomplie_commands)
        "--background-index",
        // åŒæ—¶å¼€å¯çš„ä»»åŠ¡æ•°é‡
        "-j=8",
        // "--folding-ranges"
        // å‘Šè¯‰clangdç”¨é‚£ä¸ªclangè¿›è¡Œç¼–è¯‘ï¼Œè·¯å¾„å‚è€ƒwhich clang++çš„è·¯å¾„
        "--query-driver=/usr/bin/clang++",
        // clang-tidyåŠŸèƒ½
        "--clang-tidy",
        "--clang-tidy-checks=performance-*,bugprone-*",
        // å…¨å±€è¡¥å…¨ï¼ˆä¼šè‡ªåŠ¨è¡¥å……å¤´æ–‡ä»¶ï¼‰
        "--all-scopes-completion",
        // æ›´è¯¦ç»†çš„è¡¥å…¨å†…å®¹
        "--completion-style=detailed",
        "--function-arg-placeholders",
        // è¡¥å……å¤´æ–‡ä»¶çš„å½¢å¼
        "--header-insertion=iwyu",
        // pchä¼˜åŒ–çš„ä½ç½®
        "--pch-storage=memory",
    ],
}
```
# è¨˜å¾—è¦å°‡æª”æ¡ˆç·¨è­¯æˆdebugæ¨¡å¼

# åƒè€ƒæ–‡ç« 
https://blog.csdn.net/witton/article/details/130944663
https://code.visualstudio.com/docs/editor/variables-reference

lldbå®‰è£  
https://blog.csdn.net/witton/article/details/130944663

# æ¨è–¦å¥—ä»¶
Clangd  https://clangd.llvm.org/
LLDB
ccls https://github.com/MaskRay/ccls

GDBFrontend 
https://github.com/rohanrhu/gdb-frontend


llvm-vs-code-extensions.vscode-clangd: c++ language server

usernamehw.errorlens: inline error messages, very nice

twxs.cmake: cmake coloring, not perfect but better than nothing

PKief.material-icon-theme: colors ğŸ¤—
https://www.reddit.com/r/cpp/comments/wrav6e/what_is_the_best_c_extensions_for_vs_code/